<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transfer Overbooking - PayPak</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="../../css/style.css">
</head>
<body>
    <div class="container mt-5">
        <div class="row justify-content-center">
            <div class="col-md-8">
                <div class="card shadow">
                    <div class="card-header bg-warning text-dark">
                        <h4 class="mb-0"><i class="bi bi-exclamation-triangle me-2"></i>Transfer Overbooking</h4>
                    </div>
                    <div class="card-body">
                        <!-- Alert Info -->
                        <div class="alert alert-warning">
                            <i class="bi bi-info-circle me-2"></i>
                            <strong>Transfer Overbooking</strong> memungkinkan Anda melakukan transfer melebihi saldo yang tersedia. 
                            Transfer ini memerlukan persetujuan khusus dan akan dikenakan biaya administrasi tambahan sebesar <strong>Rp 25.000</strong>.
                        </div>

                        <!-- Info Saldo -->
                        <div class="row mb-3">
                            <div class="col-6">
                                <div class="card border-success">
                                    <div class="card-body text-center">
                                        <small class="text-muted">Saldo Tersedia</small>
                                        <h5 class="text-success" id="saldoTersedia">Rp 5.250.000</h5>
                                    </div>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="card border-info">
                                    <div class="card-body text-center">
                                        <small class="text-muted">Limit Overbooking</small>
                                        <h5 class="text-info">Rp 2.000.000</h5>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Form Transfer Overbooking -->
                        <form id="overbookingForm">
                            <div class="mb-3">
                                <label for="rekeningAsal" class="form-label">Rekening Asal</label>
                                <input type="text" class="form-control" id="rekeningAsal" value="1234567890 - User PayPak" readonly>
                            </div>

                            <div class="mb-3">
                                <label for="rekeningTujuan" class="form-label">Rekening Tujuan <span class="text-danger">*</span></label>
                                <div class="input-group">
                                    <input type="text" class="form-control" id="rekeningTujuan" placeholder="Masukkan nomor rekening tujuan" required>
                                    <button class="btn btn-outline-warning" type="button" onclick="cekRekeningOverbooking()">
                                        <i class="bi bi-search"></i> Cek
                                    </button>
                                </div>
                            </div>

                            <div class="mb-3" id="namaTujuanDiv" style="display: none;">
                                <label class="form-label">Nama Penerima</label>
                                <div class="alert alert-success mb-0">
                                    <i class="bi bi-check-circle me-2"></i>
                                    <strong id="namaPenerima"></strong>
                                </div>
                            </div>

                            <div class="mb-3">
                                <label for="jumlahTransfer" class="form-label">Jumlah Transfer <span class="text-danger">*</span></label>
                                <div class="input-group">
                                    <span class="input-group-text">Rp</span>
                                    <input type="number" class="form-control" id="jumlahTransfer" placeholder="0" min="5260000" required onkeyup="hitungOverbook()">
                                </div>
                                <small class="form-text text-muted">Harus melebihi saldo tersedia (> Rp 5.250.000)</small>
                            </div>

                            <div class="mb-3" id="infoOverbook" style="display: none;">
                                <div class="alert alert-danger">
                                    <div class="d-flex justify-content-between">
                                        <span>Jumlah Overbook:</span>
                                        <strong id="jumlahOverbook">Rp 0</strong>
                                    </div>
                                    <div class="d-flex justify-content-between">
                                        <span>Biaya Admin:</span>
                                        <strong>Rp 25.000</strong>
                                    </div>
                                    <hr>
                                    <div class="d-flex justify-content-between">
                                        <span><strong>Total yang Dibutuhkan:</strong></span>
                                        <strong id="totalDibutuhkan">Rp 0</strong>
                                    </div>
                                </div>
                            </div>

                            <div class="mb-3">
                                <label for="berita" class="form-label">Berita Transfer</label>
                                <textarea class="form-control" id="berita" rows="2" placeholder="Keterangan transfer" maxlength="100"></textarea>
                            </div>

                            <div class="mb-3">
                                <label for="alasanOverbooking" class="form-label">Alasan Overbooking <span class="text-danger">*</span></label>
                                <select class="form-select" id="alasanOverbooking" required>
                                    <option value="">Pilih alasan...</option>
                                    <option value="darurat">Keperluan Darurat</option>
                                    <option value="bisnis">Keperluan Bisnis</option>
                                    <option value="medis">Keperluan Medis</option>
                                    <option value="pendidikan">Keperluan Pendidikan</option>
                                    <option value="lainnya">Lainnya</option>
                                </select>
                            </div>

                            <div class="mb-3">
                                <label for="nomorTelepon" class="form-label">Nomor Telepon Konfirmasi <span class="text-danger">*</span></label>
                                <input type="tel" class="form-control" id="nomorTelepon" placeholder="08xxxxxxxxxx" required>
                                <small class="form-text text-muted">Kami akan menghubungi Anda untuk konfirmasi</small>
                            </div>

                            <div class="form-check mb-3">
                                <input class="form-check-input" type="checkbox" id="agreementCheck" required>
                                <label class="form-check-label" for="agreementCheck">
                                    Saya menyetujui <a href="#" data-bs-toggle="modal" data-bs-target="#termsModal">syarat dan ketentuan</a> transfer overbooking
                                </label>
                            </div>

                            <div class="alert alert-danger">
                                <i class="bi bi-shield-exclamation me-2"></i>
                                <strong>PENTING:</strong> Transfer overbooking memerlukan persetujuan dari pihak bank. 
                                Proses verifikasi memakan waktu 1-3 hari kerja. Anda akan dihubungi untuk konfirmasi.
                            </div>

                            <div class="d-grid gap-2">
                                <button type="submit" class="btn btn-warning btn-lg text-dark">
                                    <i class="bi bi-send-exclamation me-2"></i>Ajukan Transfer Overbooking
                                </button>
                            </div>
                        </form>
                    </div>
                    <div class="card-footer">
                        <a href="../../index.html" class="btn btn-secondary">
                            <i class="bi bi-arrow-left me-2"></i>Kembali ke Dashboard
                        </a>
                    </div>
                </div>

                <!-- Riwayat Pengajuan -->
                <div class="card shadow mt-4">
                    <div class="card-header bg-light">
                        <h5 class="mb-0"><i class="bi bi-clock-history me-2"></i>Riwayat Pengajuan Overbooking</h5>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-sm">
                                <thead>
                                    <tr>
                                        <th>Tanggal</th>
                                        <th>Rekening Tujuan</th>
                                        <th>Jumlah</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>10/01/2025</td>
                                        <td>5556667778</td>
                                        <td>Rp 6.000.000</td>
                                        <td><span class="badge bg-warning">Pending</span></td>
                                    </tr>
                                    <tr>
                                        <td>05/01/2025</td>
                                        <td>9998887776</td>
                                        <td>Rp 5.500.000</td>
                                        <td><span class="badge bg-success">Disetujui</span></td>
                                    </tr>
                                    <tr>
                                        <td>28/12/2024</td>
                                        <td>1112223334</td>
                                        <td>Rp 7.000.000</td>
                                        <td><span class="badge bg-danger">Ditolak</span></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Syarat dan Ketentuan -->
    <div class="modal fade" id="termsModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Syarat dan Ketentuan Transfer Overbooking</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <ol>
                        <li>Transfer overbooking hanya dapat dilakukan oleh nasabah yang memiliki riwayat transaksi baik.</li>
                        <li>Limit maksimal overbooking adalah Rp 2.000.000 dari saldo yang tersedia.</li>
                        <li>Biaya administrasi sebesar Rp 25.000 akan dikenakan untuk setiap transaksi.</li>
                        <li>Nasabah wajib mengembalikan jumlah overbooking dalam waktu maksimal 30 hari.</li>
                        <li>Bunga sebesar 2% per bulan akan dikenakan untuk jumlah overbooking.</li>
                        <li>Bank berhak menolak pengajuan tanpa memberikan alasan.</li>
                        <li>Keterlambatan pengembalian akan dikenakan denda sebesar 5% dari jumlah overbooking.</li>
                    </ol>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Tutup</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        const saldoTersedia = 5250000;
        const limitOverbook = 2000000;

        function cekRekeningOverbooking() {
            const rekening = document.getElementById('rekeningTujuan').value;
            if (rekening.length < 10) {
                alert('Nomor rekening minimal 10 digit');
                return;
            }

            document.getElementById('namaTujuanDiv').style.display = 'block';
            document.getElementById('namaPenerima').textContent = 'Penerima ' + rekening;
        }

        function hitungOverbook() {
            const jumlah = parseInt(document.getElementById('jumlahTransfer').value) || 0;
            
            if (jumlah > saldoTersedia) {
                const overbook = jumlah - saldoTersedia;
                
                if (overbook > limitOverbook) {
                    alert('Jumlah overbooking melebihi limit! Maksimal Rp ' + (saldoTersedia + limitOverbook).toLocaleString('id-ID'));
                    document.getElementById('jumlahTransfer').value = saldoTersedia + limitOverbook;
                    hitungOverbook();
                    return;
                }

                const biayaAdmin = 25000;
                const total = jumlah + biayaAdmin;

                document.getElementById('infoOverbook').style.display = 'block';
                document.getElementById('jumlahOverbook').textContent = 'Rp ' + overbook.toLocaleString('id-ID');
                document.getElementById('totalDibutuhkan').textContent = 'Rp ' + total.toLocaleString('id-ID');
            } else {
                document.getElementById('infoOverbook').style.display = 'none';
            }
        }

        document.getElementById('overbookingForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const rekTujuan = document.getElementById('rekeningTujuan').value;
            const jumlah = parseInt(document.getElementById('jumlahTransfer').value);
            const alasan = document.getElementById('alasanOverbooking').value;
            const noTelp = document.getElementById('nomorTelepon').value;
            const agreement = document.getElementById('agreementCheck').checked;
            
            if (!rekTujuan || !jumlah || !alasan || !noTelp || !agreement) {
                alert('Mohon lengkapi semua data yang diperlukan');
                return;
            }

            if (jumlah <= saldoTersedia) {
                alert('Jumlah transfer harus melebihi saldo tersedia untuk menggunakan overbooking');
                return;
            }

            const overbook = jumlah - saldoTersedia;
            
            if (confirm('Apakah Anda yakin mengajukan transfer overbooking sebesar Rp ' + jumlah.toLocaleString('id-ID') + '?\n\n' +
                       'Overbook: Rp ' + overbook.toLocaleString('id-ID') + '\n' +
                       'Biaya Admin: Rp 25.000\n' +
                       'Total: Rp ' + (jumlah + 25000).toLocaleString('id-ID') + '\n\n' +
                       'Pengajuan ini akan diproses dalam 1-3 hari kerja.')) {
                alert('Pengajuan transfer overbooking berhasil dikirim!\n\n' +
                      'Nomor Referensi: OVB' + Date.now() + '\n' +
                      'Anda akan dihubungi melalui nomor ' + noTelp + ' untuk konfirmasi.');
                this.reset();
                document.getElementById('namaTujuanDiv').style.display = 'none';
                document.getElementById('infoOverbook').style.display = 'none';
            }
        });
    </script>
</body>
</html>
